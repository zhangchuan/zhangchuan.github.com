
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>研究中心</title>
  <meta name="author" content="Cloud.Zhang">

  
  <meta name="description" content="第2章 Python 简介 1.1 运行Python
1.2 变量和算术表达式
1.3 条件语句
1.4 文件输入和输出
1.5 字符串
1.6 列表
1.7 元组
1.8 集合
1.9 字典
1.10 迭代与循环
1.11 函数
1.12 生成器
1.13 协程
1.14 对象与类
1.15 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://zhangchuan.github.com/blog/page/22">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="研究中心" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:zhangchuan.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/09/175416-python/">Python 参考手册 第1章</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-09T17:54:00+08:00" pubdate data-updated="true">Jan 9<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>第2章 Python 简介</h1>

<ul>
<li><a href="#1.1">1.1 运行Python</a></li>
<li><a href="#1.2">1.2 变量和算术表达式</a></li>
<li><a href="#1.3">1.3 条件语句</a></li>
<li><a href="#1.4">1.4 文件输入和输出</a></li>
<li><a href="#1.5">1.5 字符串</a></li>
<li><a href="#1.6">1.6 列表</a></li>
<li><a href="#1.7">1.7 元组</a></li>
<li><a href="#1.8">1.8 集合</a></li>
<li><a href="#1.9">1.9 字典</a></li>
<li><a href="#1.10">1.10 迭代与循环</a></li>
<li><a href="#1.11">1.11 函数</a></li>
<li><a href="#1.12">1.12 生成器</a></li>
<li><a href="#1.13">1.13 协程</a></li>
<li><a href="#1.14">1.14 对象与类</a></li>
<li><a href="#1.15">1.15 异常</a></li>
<li><a href="#1.16">1.16 模块</a></li>
<li><a href="#1.17">1.17 获得帮助</a></li>
</ul>


<h1 id=1.1>1.1 运行Python</h1>


<pre><code>$ python
&gt;&gt;&gt; print "Hello World"
&gt;&gt;&gt; print("Hello World") #python 3
</code></pre>

<p>桌面计算器, _用于保存最后一次运算结果,并只在交互式环境中才有效</p>

<pre><code>&gt;&gt;&gt; 6000 + 4523.50 + 134.12
&gt;&gt;&gt; _ + 8192.32
</code></pre>

<p>创建程序, #表示整个一行都是注释</p>

<pre><code># helloworld.py
print "Hello World"
</code></pre>

<p>执行程序</p>

<pre><code>$ python helloworld.py
</code></pre>

<p>退出程序, 输入EOF. UNIX(Ctrl+D),Windows(Ctrl+Z).通过程序抛出SystemExit异常</p>

<pre><code>&gt;&gt;&gt; raise SystemExit
</code></pre>

<h1 id=1.2>1.2 变量和算术表达式</h1>


<p><strong>程序清单1-1 简单的复利计算</strong></p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">principal</span> <span class="o">=</span> <span class="mi">1000</span>    <span class="c"># 初始金额</span>
</span><span class='line'><span class="n">rate</span> <span class="o">=</span> <span class="mf">0.05</span>         <span class="c"># 利率</span>
</span><span class='line'><span class="n">numyears</span> <span class="o">=</span> <span class="mi">5</span>        <span class="c"># 年数</span>
</span><span class='line'><span class="n">year</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'><span class="k">while</span> <span class="n">year</span> <span class="o">&lt;=</span> <span class="n">numyears</span><span class="p">:</span>
</span><span class='line'>    <span class="n">principal</span> <span class="o">=</span> <span class="n">principal</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rate</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">year</span><span class="p">,</span> <span class="n">principal</span> <span class="c"># 注意在Python3中是print(year, principal)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Python是一种动态类型语言,变量名无类型,但在执行过程中可以引用任意类型的数据</p>

<pre><code># principal名称引用的值的类型由integer动态变为了float
principal = principal * (1 + rate)
</code></pre>

<p>换行代表一条语句的结束,也可在同一行上使用分号隔开多条语句</p>

<pre><code>principal = 1000; rate = 0.05; numyears = 5;
</code></pre>

<p>while语句对条件表达式进行判断,True执行循环主体,False退出循环.建议每个缩进层次用4个空格.</p>

<p>字符串格式化运算符%</p>

<pre><code># 将principal精度限制为2位
print "%3d %0.2f" % (year, principal)
print("%3d %0.2f" % (year, principal))  #Python 3
</code></pre>

<p>整数 &#8220;%d&#8221;, 字符串 &#8220;%s&#8221;, 浮点数 &#8220;%f&#8221;</p>

<p>更新的字符串格式方法</p>

<pre><code>print format(year, "3d"), format(principal, "0.2f")
print(format(year, "3d"), format(principal, "0.2f"))  #Python 3
</code></pre>

<p>一次格式化多个字符串</p>

<pre><code>print "{0:3d} {1:0.2f}".format(year, principal)
print("{0:3d} {1:0.2f}".format(year, principal))    #Python 3    
</code></pre>

<h1 id=1.3>1.3 条件语句</h1>


<pre><code>if a &lt; b:
    print "Computer says Yes"
else:
    print "Computer says No"
# if和elase主体用缩进表示,else子句可选.
</code></pre>

<p>用pass语句用于创建空子句</p>

<pre><code>if a &lt; b:
    pass    # Do nothing
else:
    print "Computer says No"
</code></pre>

<p>使用or, and和not关键字可以创建布尔类型表达式</p>

<pre><code>if product == "game" and type == "pirate memory" \
                     and not (age &lt; 4 or age &gt; 8):
    print "I'll take it!"
</code></pre>

<p>elif语句, 处理多个测试</p>

<pre><code>if suffix == ".htm":
    content = "text/html"
elif suffix == ".jpg":
    content = "image/jpeg"
elif suffix == ".png":
    content = "image/png"
else:
    raise RuntimeError("Unknown content type")
</code></pre>

<p>in运算符用于检查某个值是否包含在另一个对象, 返回True/False</p>

<pre><code>if 'spam' in s:
    has_spam = True
else:
    has_spam = False
# 可缩写为 has_spam = 'spam' in s
</code></pre>

<h1 id=1.4>1.4 文件输入和输出</h1>


<p>打开文件并逐行读取内容</p>

<pre><code>f = open("foo.txt")     #返回一个文件对象
line = f.readline()     #调用文件的readline()方法
while line:
    print line,         #后面跟','将忽略换行符
    # print(line, end='')   #Python 3
    line = f.readline()
f.close()
</code></pre>

<p>open()函数返回一个新的文件对象, readline()方法读取一行内容,包括结尾的换行符, 读至结尾返回空字符串</p>

<pre><code>for line in open("foo.txt"):
    print line,
</code></pre>

<p>将程序输出到文件中,print >> 文件</p>

<pre><code>f = open("out", "w")    #打开文件以便写入
while year &lt;= numyears:
    principal = principal * (1 + rate)
    print &gt;&gt;f, "%3d %0.2f" % (year, principal)
    year += 1
f.close()
</code></pre>

<p>>>语法只能用于Python 2中, Python 3:</p>

<pre><code>print("%3d %0.2f" % (year, principal), file=f)
</code></pre>

<p>文件对象支持使用write()方法写入原始数据</p>

<pre><code>f.write("%d %0.2f" % (year, principal))
</code></pre>

<p>输入流从读取sys.stdin文件,输出流写入sys.stdout文件</p>

<pre><code>import sys
sys.stdout.write("Enter your name :")
name = sys.stdin.readline()
#Python 2可简化为
name = raw_input("Enter your name :")
#Python 3 raw_input函数叫做input()
</code></pre>

<h1 id=1.5>1.5 字符串</h1>


<p>将字符串放在单引号,双引号,三引号中创建字符串</p>

<pre><code>a = "Hello World"
b = 'Python is groovy'
c = """Computer says 'No'"""
</code></pre>

<p>引号必须对应匹配,单引号和双引号的字符串必须在一个逻辑行.三引号可放于多个文本行</p>

<pre><code>print '''Content-type: text/html

&lt;h1&gt; Hello World &lt;/h1&gt;
Click &lt;a href="http://www.python.org"&gt;here&lt;/a&gt;.
'''
</code></pre>

<p>字符串存储在以0开始, 使用整数索引的字符序列中. 要提取其中一个字符, 可以使用索引运算符s[i]</p>

<pre><code>a = "Hello World"
b = a[4]    # b = 'o'
</code></pre>

<p>使用切片运算符s[i:j]提取子字符串. 省略i, 起始开始. 省略j, 结束为至</p>

<pre><code>c = a[:5]   # c = "Hello"
d = a[6:]   # d = "World"  ## d = a[5:] d = " World"
e = a[3:8]  # e = "lo Wo"
</code></pre>

<p>+运算符连接字符串</p>

<pre><code>g = a + " This is a test"
</code></pre>

<p>Python不会把字符串的值转换成数值</p>

<pre><code>x = "37"
y = "42"
z = x + y   # z = "3742" (字符串连接)
</code></pre>

<p>int(), float() 将字符串值转换为数值</p>

<pre><code>z = int(x) + int(y) # z = 79 (Integer +)
</code></pre>

<p>str(), repr(), format() 将非字符串值转换为字符串形式</p>

<pre><code>s = "The value of x is " + str(x)
s = "The value of x is " + repr(x)
s = "The value of x is " + format(x,"4d")
</code></pre>

<p>str()输出与print相同, repr()表示输出对象在程序中的值</p>

<pre><code>&gt;&gt;&gt; x = 3.4
&gt;&gt;&gt; str(x)
&gt;&gt;&gt; repr(x)     # 计算机无法精确表示十进制小数,
&gt;&gt;&gt; format(x, "0.5f")
</code></pre>

<h1 id=1.6>1.6 列表</h1>


<p>将任意对象放在方括号中创建列表</p>

<pre><code>name = [ "Dave", "Mark", "Ann", "Phil" ]
</code></pre>

<p>列表从0开始整数索引,索引运算符可访问并修改列表的项</p>

<pre><code>a = names[2]        # 返回列表的第3项"Ann"
name[0] = "Jeff"    # 将第1项改为"Jeff"
</code></pre>

<p>append(), 将新项追加到列表末尾</p>

<pre><code>names.append("Paula")
</code></pre>

<p>insert(), 将一项插入到列表</p>

<pre><code>names.insert(2, "Thomas")
</code></pre>

<p>切片运算符, 提取子列表并对其赋值</p>

<pre><code>b = names[0:2]      # 返回[ "Jeff", "Mark" ]
c = names[2:]       # 返回[ "Thomas", "Ann", "Phil", "Paula" ]
names[1] = 'Jeff'   # 将names中第第2项替换为'Jeff'
names[0:2] = ['Dave', 'Mark', 'Jeff']   #将列表的头两项替换为右边的列表
</code></pre>

<p>+运算符连接列表</p>

<pre><code>a = [1,2,3] + [4,5] # 结果是[1,2,3,4,5]
</code></pre>

<p>创建空列表</p>

<pre><code>names = []      # 一个空列表
names = list()  # 一个空列表
</code></pre>

<p>列表可以包括任意种类的Python对象,包括其他列表</p>

<pre><code>a = [1,"Dave",3.14, ["Mark", 7, 9, [100,101]], 10]
</code></pre>

<p>嵌套列表需要多次索引运算进行访问</p>

<pre><code>a[1]        # 返回"Dave"
a[3][2]     # 返回9
a[3][3][1]  # 返回101
</code></pre>

<p><strong>程序清单1-2 列表的高级特性</strong></p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">sys</span>              <span class="c"># 加载sys模块</span>
</span><span class='line'><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span>   <span class="c"># 检查命令行参数的数量</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;Please supply a filename&quot;</span>
</span><span class='line'>    <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>   <span class="c"># 命令行上的文件名</span>
</span><span class='line'><span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>   <span class="c"># 将所有行读取到一个列表中</span>
</span><span class='line'><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="c"># 将所有输入值从字符串转换为浮点数</span>
</span><span class='line'><span class="n">fvalues</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="c"># 打印最小值和最大值</span>
</span><span class='line'><span class="k">print</span> <span class="s">&quot;The minimum value is &quot;</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">fvalues</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="s">&quot;The maximum value is &quot;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">fvalues</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>转换值的代码可简化为</p>

<pre><code>fvalues = [float(line) for line in open(sys.argv[1])]
</code></pre>

<h1 id=1.7>1.7 元组</h1>


<p>将任意对象放在圆括号中创建列表</p>

<pre><code>stock = ('GOOG', 100, 490.10)
address = ('www.python.org', 80)
person = (first_name, last_name, phone)
</code></pre>

<p>可以省略圆括号</p>

<pre><code>stock = 'GOOG', 100, 490.10
address = 'www.python.org', 80
person = first_name, last_name, phone
</code></pre>

<p>0个和1个元素的元组</p>

<pre><code>a = ()      # 0-元组(空元组)
b = (item,) # 1-元组(注意随后的逗号)
c = (item,) # 1-元组(注意随后的逗号)
</code></pre>

<p>将元祖解包为一组变量</p>

<pre><code>name, shares, price = stock
host, port = address
first_name, last_name, phone = person
</code></pre>

<p>创建元组后不能对其修改(替换,删除,插入), 列表可以,但如果程序创建了大量小列表(项&lt;12),会造成内存浪费</p>

<p>字符串split()方法按指定的分割符将一个字符串划分为一个字段列表</p>

<pre><code># 文件中各行的格式为"name, shares, price"
filename = "portfolio.csv"
portfolio = []
for line in open(filename):
    fields = line.split(",")        # 将每行划分为一个列表
    name = fields[0]                # 提取并转换每个字段
    shares = int(fields[1])
    price = float(fields[2])
    stock = (name, shares, price)   # 创建一个元祖(name, shares, price)
    portfolio.append(stock)         # 将记录追加到列表中
&gt;&gt;&gt; portfolio[0]
&gt;&gt;&gt; portfolio[1]
&gt;&gt;&gt; portfolio[1][1]
&gt;&gt;&gt; portfolio[1][2]
# 更简单的方法
total = 0.0
for name, shares, price in portfolio:
    total += shares * price
</code></pre>

<h1 id=1.8>1.8 集合</h1>


<p>使用set函数创建集合</p>

<pre><code>s = set([3,5,9,10])     # 创建一个数值集合
t = set("Hello")        # 创建一个唯一字符的集合
</code></pre>

<p>集合是无序的</p>

<pre><code>&gt;&gt;&gt; t
set(['H', 'e', 'l', 'o'])   # 注意只出现了一个'l'
a = t | s       # t和s的并集
b = t &amp; s       # t和s的交集
c = t - s       # 求差集(项在t中,但不在s中)
d = t ^ s       # 对称基集(项在t或s中, 但不会同时出现在二者中)
</code></pre>

<p>add(), update()在集合中添加新项</p>

<pre><code>t.add('x')              # 添加一项
s.update([10,37,42])    # 在s中添加多项
</code></pre>

<p>remove() 删除一项</p>

<pre><code>t.remove('H')
</code></pre>

<h1 id=1.9>1.9 字典</h1>


<p>将关联数组或散列表放入大括号中{}创建字典</p>

<pre><code>stock = {
    "name"  : "GOOG",
    "shares": 100,
    "price" : 490.10    
}
</code></pre>

<p>访问字典成员</p>

<pre><code>name = stock["name"]
value = stock["shares"] * stock["price"]
</code></pre>

<p>插入修改对象</p>

<pre><code>stock["shares"] = 75
stock["date"]   = "June 7, 2007" 
</code></pre>

<p>可变对象不可用作关键字
字典可作为快速查找序数据的一个容器</p>

<pre><code># 股票价格
price = {
    "GOOG" : 490.10,
    "AAPL" : 123.50,
    "IBM"  : 91.50,
    "MSFT" : 52.13
}
</code></pre>

<p>创建空字典</p>

<pre><code>prices = {}     # 一个空字典
prices = dict{} # 一个空字典
</code></pre>

<p>in运算符测试是否为字典成员</p>

<pre><code>if "SCOX" in prices:
    p = prices["SCOX"]
else:
    p = 0.0
# 更简洁的方法
p = price.get("SCOX", 0.0)
</code></pre>

<p>获得字典关键字列表</p>

<pre><code>syms = list(prints) # syms = ["AAPL", "MSFT", "IBM", "GOOG"]
</code></pre>

<p>del语句删除字典元素</p>

<pre><code>del prices["MSFT"]
</code></pre>

<h1 id=1.10>1.10 迭代与循环</h1>


<p>每次迭代将列表[1,2,3,4,&#8230;&#8230;,9]中的下一个值赋给变量n.</p>

<pre><code>for n in [1,2,3,4,5,6,7,8,9]:
    print "2 to the %d power is %d" % (n, 2**n)
# 更简洁的方法
for n in range(1,10):
    print "2 to the %d power is %d" % (n, 2**n)
</code></pre>

<p>range(i,j,[,步进值]) i到j-1, i省略默认为0</p>

<pre><code>a = range(5)        # a = 0,1,2,3,4
a = range(1,8)      # a = 1,2,3,4,5,6,7
c = range(1,14,3)   # a = 0,3,6,9,12
d = range(8,1,-1)   # a = 8,7,6,5,4,3,2
</code></pre>

<p>xrange()用于处理极大范围的整数值.Python3中已更名为range()</p>

<p>for语句可迭代多种对象,包括字符串, 列表, 字典和文件</p>

<pre><code>a = "Hello World"
# 打印出a中的每个字符
for c in a:
    print c

b = ["Dave", "Mark", "Ann", "Phil"]
# 打印出一个列表的成员
for name in b:
    print name
c = { 'GOOG':490.10, 'IBM':91.50, 'AAPL':123.15 }
# 打印出一个字典的所有成员
for key in c:
    print key, c[key]

# 打印一个文件中的所有行
f = open("foo.txt")
for line in f:
    print line,
</code></pre>

<h1 id=1.11>1.11 函数</h1>


<p>使用def语句创建函数</p>

<pre><code>def remainder(a,b):
    q = a // b      # //是截断除法运算符
    r = a - q*b
    return r 
</code></pre>

<p>调用函数</p>

<pre><code>result = remainder(37,15)
</code></pre>

<p>让函数返回多个值</p>

<pre><code>def divide(a,b):
    q = q // b      # 如果a和b是整数, q就是整数
    r = a - q*b
    return (q,r)
</code></pre>

<p>讲结果放到单独的变量中</p>

<pre><code>quotient, remainder = divide(1456,33)
</code></pre>

<p>给函数参数提供默认值, 调用此函数时可省略</p>

<pre><code>def connect(hostname, port, timeout=300):
    # 函数体
connect('www.python.org', 80)
</code></pre>

<p>使用关键字参数调用函数</p>

<pre><code>connect(port=80, hostname="www.python.org")
</code></pre>

<p>变量定义在函数中,作用域只在函数体内,要修改全局变量的值, 可用global语句</p>

<pre><code>count = 0
...
def foo():
    global count
    count += 1      # 更改全局变量count
</code></pre>

<h1 id=1.12>1.12 生成器</h1>


<p>yield语句可让函数生成一个结果序列</p>

<pre><code>def countdown(n):
    print "Counting down!"
    while n &gt; 0:
        yield n     # 生成一个值(n)
        n -= 1
</code></pre>

<p>生成器创建一个对象, 连续调用next()方法生成结果序列(Python3中是<strong>next</strong>())</p>

<pre><code>&gt;&gt;&gt; c = countdown(5)
&gt;&gt;&gt; c.next()
&gt;&gt;&gt; c.next()
&gt;&gt;&gt; c.next()
&gt;&gt;&gt;
# 通常使用for 循环调用
&gt;&gt;&gt; for i in countdown(5):
    print i,
</code></pre>

<p>模拟UNIX tail -f命令</p>

<pre><code>import time
def tail(f):
    f.seek(0,2)     # 移动到EOF
    while True:
        line = f.readline() #尝试读取一个新的文件行
        if not line:
            time.sleep(0.1)
            continue
        yield line
</code></pre>

<p>在多行中查找特定字符串</p>

<pre><code>def grep(lines, searchtext):
    for line in lines:
        if searchtext in line:  yield line

# UNIX "tail -f | grep python"命令的python实现
wwwlog = tail(open("access-log"))
pylines = grep(wwwlog, "python")
for line in pylines:
    print line,
</code></pre>

<h1 id=1.13>1.13 协程</h1>


<p>以表达式(yield)形式创建协程</p>

<pre><code>def print_matches(matchtext):
    print "Looking for", matchtext
    while True:
        line = (yield)      # 获得一行文本
        if matchtext in line:
            print line
</code></pre>

<p>向前执行第一条(yield)语句, 然后用send()发送数据</p>

<pre><code>&gt;&gt;&gt; matcher = print_matches("python")
&gt;&gt;&gt; matcher.next()      # 向前执行到第一条(yield)语句
&gt;&gt;&gt; matcher.send("Hello World")
&gt;&gt;&gt; matcher.send("python is cool")
&gt;&gt;&gt; matcher.send("yow!")
&gt;&gt;&gt; matcher.close()     # 匹配器函数调用结束
</code></pre>

<p>共同使用生成器和协程的例子</p>

<pre><code># 一组匹配器协程
matchers = [
    print_matches("python"),
    print_matches("guido"),
    print_matches("jython")
]
# 通过调用next()准备所有的匹配器
for m in matchers: m.next()
# 为所有匹配器提供一个活动的日志文件, 为此
# 必须有一台活动的Web服务器将数据写入日志
wwwlog = tail(open("access-log"))
for line in wwwlog:
    for m in matchers:
        m.send(line)    # 将数据发送到每个匹配器协程中
</code></pre>

<h1 id=1.14>1.14 对象与类</h1>


<p>程序中所有值都是对象. 对象由内部数据和各种方法组成</p>

<pre><code>items = [37,42]     # 创建一个列表对象
items.append(73)    # 调用append()方法
</code></pre>

<p>列出对象可用的方法</p>

<pre><code>&gt;&gt;&gt; items = [37,42]
&gt;&gt;&gt; dir(items)
</code></pre>

<p>以双下划线开始和结束的是特殊方法</p>

<pre><code>&gt;&gt;&gt; items.__add__([73,101])
</code></pre>

<p>class语句用于定义新的对象类型. object是所有Python类型的根类型, def语句定义方法, 方法的self参数作为第一个参数, 指向对象本身. <strong>init</strong>用于初始化对象</p>

<pre><code>class Stack(object):
    def __init__(self):     # 初始化栈
        self.stack = []
    def push(self, object):
        self.stack.append(object)
    def pop(self):
        return self.stack.pop()
    def length(self):
        return len(self.stack)
</code></pre>

<p>使用类</p>

<pre><code>s = Stack()     # 创建一个栈
s.push("Dave")  # 在栈中放入一些内容
s.push(42)
s.push([3,4,5])
x = s.pop()     # x的值为[3,4,5]
y = s.pop()     # y的值为42
del s           # 删除s
</code></pre>

<p>继承list</p>

<pre><code>class Stack(list):
    # 为栈接口添加push()方法
    # 注意: 列表已提供一个pop()方法
    def push(self, object):
        self.append(object)
</code></pre>

<p>静态方法</p>

<pre><code>class EventHanlder(object):
    @staticmethod
    def dispatcherThread():
        while (1):
            # 等待请求
EventHandler.dispatcherTread()  # 像函数一样调用方法
</code></pre>

<h1 id=1.15>1.15 异常</h1>


<p>如果程序出现错误会引发异常，可以使用try和except语句捕获并处理异常</p>

<pre><code>try:
    f = open("file.txt","r")
except IOError as e:
    print e
# 如果出现IOError, 引发错误的详细信息将保存在对象e中
</code></pre>

<p>raise语句用于手工引发异常</p>

<pre><code>raise RuntimeError("Computer says no")
</code></pre>

<p>管理系统资源，</p>

<pre><code>import threading
message_lock = threading.Lock()
...
with message_lock:
    message.add(newmessage)
# with语句执行会自动获取message_lock对象, 离开with代码块后锁定会自动释放
</code></pre>

<h1 id=1.16>1.16 模块</h1>


<p>模块文件的后缀必须是.py</p>

<pre><code># file : div.py
def divide(a, b):
    q = a/b     # 如果a和b是整数, 则q也是整数
    r = a - q*b
    return (q,r)
# 在其他程序中import该模块
import div
a, b = div.divide(2305, 29)
# import语句创建新的命名空间，并在新的命名空间执行.py相关的语句.
</code></pre>

<p>使用不同的名称导入模块</p>

<pre><code>import div as foo
a ,b = foo.divide(2305, 29)     # 不再使用div前缀
</code></pre>

<p>把模块所有内容加载到当前命名空间</p>

<pre><code>from div import *
</code></pre>

<p>dir函数可列出模块内容</p>

<pre><code>&gt;&gt;&gt; import string
&gt;&gt;&gt; dir(string)
</code></pre>

<h1 id=1.17>1.17 获得帮助</h1>


<p>help()获得内置模块及Python相关信息</p>

<p>help(&#8216;模块名&#8217;)获得具体模块信息</p>

<p><strong>doc</strong>属性, 获得函数用途的文档说明</p>

<pre><code>&gt;&gt;&gt; print issubclass.__doc__
</code></pre>

<p>pydoc命令返回python模块文档</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/23/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/21/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1></h1>
  <img src="/images/newton.gif">
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/03/06/160015-redis/">redis 入门手册</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/06/150903-python/">Python 参考手册 第4章</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/02/091722-rabbitmq/">RabbitMQ 消息队列应用</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/01/154153-mongodb/">MongoDB权威指南 7</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/01/142455-mongodb/">MongDB权威指南 6</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/01/104304-mongodb/">MongoDB权威指南 5</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/28/084414-python/">MongoDB权威指南 4</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/23/120934-python/">MongoDB权威指南 3</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/22/141006-mongodb/">monogodb 大杂烩</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/15/143830-scribe/">scribe安装</a>
      </li>
    
  </ul>
</section>

<section>
<h1>Categories</h1>
<span class='categories_tag'> <a href='/blog/categories/blog' style='font-size: 116.36363636363636%'>Blog(3)</a>  <a href='/blog/categories/database' style='font-size: 132.72727272727272%'>Database(6)</a>  <a href='/blog/categories/git' style='font-size: 105.45454545454545%'>Git(1)</a>  <a href='/blog/categories/mongodb' style='font-size: 132.72727272727272%'>Mongodb(6)</a>  <a href='/blog/categories/monitor' style='font-size: 105.45454545454545%'>Monitor(1)</a>  <a href='/blog/categories/munin' style='font-size: 105.45454545454545%'>Munin(1)</a>  <a href='/blog/categories/python' style='font-size: 160.0%'>Python(11)</a>  <a href='/blog/categories/rabbitmq' style='font-size: 105.45454545454545%'>Rabbitmq(1)</a>  <a href='/blog/categories/read' style='font-size: 160.0%'>Read(11)</a>  <a href='/blog/categories/redis' style='font-size: 127.27272727272728%'>Redis(5)</a>  <a href='/blog/categories/scribe' style='font-size: 105.45454545454545%'>Scribe(1)</a> </span>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p align="right" style="width: 75%">
  Copyright &copy; 2012 - Cloud.Zhang
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
